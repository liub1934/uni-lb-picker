<template>
  <view class="list">
    <view class="grey-block"></view>
    <view class="list-item"
      @tap="handleTap('picker1')">
      <text class="sub-title">年月日选择</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value1 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker1"
        v-model="value1"
        mode="dateSelector"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="list-item"
      @tap="handleTap('picker2')">
      <text class="sub-title">年月日默认值</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value2 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker2"
        v-model="value2"
        mode="dateSelector"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="list-item"
      @tap="handleTap('picker3')">
      <text class="sub-title">开始结束日期限制（可精确到秒）</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value3 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker3"
        v-model="value3"
        mode="dateSelector"
        :start-date="startDate"
        :end-date="endDate"
        format="YYYY-MM-DD HH:mm:ss"
        display-format="YYYY-MM-DD-HH-mm-ss"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="list-item"
      @tap="handleTap('picker4')">
      <text class="sub-title">不显示年月日等日期文字</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value4 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker4"
        v-model="value4"
        mode="dateSelector"
        :is-show-chinese="false"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="list-item"
      @tap="handleTap('picker5')">
      <text class="sub-title">自定义显示年月日等文字</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value5 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker5"
        v-model="value5"
        mode="dateSelector"
        :ch-config="{
          year: '年年',
          month: '月月',
          day: '日日'
        }"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="list-item"
      @tap="handleTap('picker6')">
      <text class="sub-title">高级formatter自定义显示</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value6 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker6"
        v-model="value6"
        mode="dateSelector"
        :formatter="formatter"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="list-item"
      @tap="handleTap('picker7')">
      <text class="sub-title">format格式化日期</text>
      <view class="item-content">
        <text class="item-title">绑定值:{{ value7 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker7"
        v-model="value7"
        mode="dateSelector"
        format="天朝YYYY年第MM月第DD日"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>

    <view class="radios">
      <radio-group class="radio-group"
        @change="radioChange">
        <view v-for="n in format"
            :key="n">
          <label class="flex-row-center">
            <radio :value="n"
              :checked="n === curFormat"> </radio>
            <text class="item-label">{{ n }}</text>
          </label>
        </view>
      </radio-group>
    </view>
    <view class="list-item"
      @tap="handleTap('picker8')">
      <text class="sub-title">自定义显示日期颗粒，可自由组合</text>
      
      <view class="item-content">
        <text class="item-title">绑定值:{{ value8 }}</text>
        <view class="item-value">
          <text class="item-placeholder">点我打开选择器</text>
        </view>
      </view>
      <lb-picker ref="picker8"
        v-model="value8"
        mode="dateSelector"
        :format="curFormat"
        :display-format="displayFormat[curFormat]"
        @change="handleChange"
        @confirm="handleConfirm"
        @cancel="handleCancel">
      </lb-picker>
    </view>
    <view class="grey-block"></view>
  </view>
</template>

<script>
export default {
  data () {
    return {
      value1: '',
      value2: '2021-01-01',
      value3: '',
      value4: '',
      value5: '',
      value6: '',
      value7: '天朝2021年第01月第01日',
      value8: '',
      startDate: '2018-08-08 08:08:08',
      endDate: '2021-08-08 08:08:08',
      curFormat: 'YYYY',
      format: [
        'YYYY',
        'YYYY-MM',
        'YYYY-MM-DD',
        'DD日HH时mm分',
        'HH:mm:ss',
        'mm:ss',
      ],
      displayFormat: {
        'YYYY': 'YYYY',
        'YYYY-MM': 'YYYY-MM',
        'YYYY-MM-DD': 'YYYY-MM-DD',
        'DD日HH时mm分': 'DD-HH-mm',
        'HH:mm:ss': 'HH-mm-ss',
        'mm:ss': 'mm-ss',
      }
    }
  },
  onReady () {
    // this.$nextTick(() => {
    //   // 此处可以调用getColumnsInfo方法获取默认值的选项信息
    //   const info = this.$refs.picker2.getColumnsInfo(this.value2)
    //   console.log('根据value获取的信息：', info)
    //   this.label2 = info.item.label
    // })
  },
  methods: {
    handleTap (name) {
      this.$refs[name].show()
    },
    handleChange (e) {
      console.log('change::', e)
    },
    handleConfirm (e) {
      console.log('confirm::', e)
    },
    handleCancel (e) {
      console.log('cancel::', e)
    },
    formatter ({item, rowIndex, columnIndex }) {
      if (item.name === 'year') {
        return `天朝${item.value}年`
      } else if (item.name === 'month') {
        const arr = ['一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '十一', '十二']
        return `${arr[item.value - 1]}月`
      } else if (item.name === 'day') {
        return `第${item.value}日`
      }
    },
    radioChange (e) {
      this.value8 = ''
      this.curFormat = e.detail.value
    }
  }
}
</script>

<style lang="scss" scoped>
@import "../../index/index.scss";
</style>